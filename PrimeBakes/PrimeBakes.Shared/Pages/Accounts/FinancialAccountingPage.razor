@page "/Accounting"

@using PrimeBakesLibrary.Models.Accounts.FinancialAccounting;
@using PrimeBakesLibrary.Models.Accounts.Masters;
@using PrimeBakesLibrary.Models.Common;

@if (_isLoading)
{

}
else
{
	<SfDatePicker TValue="DateOnly"
				  Value="_accounting.AccountingDate"
				  Placeholder="Select Accounting Date">
		<DatePickerEvents TValue="DateOnly" ValueChange="OnAccountingDateChanged" />
	</SfDatePicker>

	<SfComboBox TValue="int"
				TItem="VoucherModel"
				Value="_accounting.VoucherId"
				DataSource="_vouchers"
				Placeholder="Select Voucher Type">
		<ComboBoxEvents TItem="VoucherModel" TValue="int" ValueChange="OnVoucherTypeChanged" />
		<ComboBoxFieldSettings Text="Name" Value="Id" />
	</SfComboBox>


	<SfTextBox Readonly="true" Value="@($"{_financialYear?.StartDate}  {_financialYear?.EndDate}")" />

	<SfTextBox Readonly="true" Value="@_accounting.TransactionNo" />

	<SfTextBox Placeholder="Financial Accounting Remarks" @bind-Value="_accounting.Remarks" />

	<SfAutoComplete TValue="LedgerModel?"
					TItem="LedgerModel"
					Value="@_selectedLedger"
					Placeholder="Search for a Ledger..."
					FloatLabelType='@FloatLabelType.Auto'
					DataSource="@_ledgers"
					AllowFiltering="true"
					FilterType="Syncfusion.Blazor.DropDowns.FilterType.Contains">
		<AutoCompleteEvents TItem="LedgerModel" TValue="LedgerModel?" ValueChange="OnLedgerChanged" />
		<AutoCompleteFieldSettings Value="Name" />
	</SfAutoComplete>

	<SfNumericTextBox TValue="decimal?"
					  Placeholder="Enter Debit"
					  Value="_selectedCart?.Debit"
					  Format="N2"
					  Min="0">
		<NumericTextBoxEvents TValue="decimal?" ValueChange="OnDebitChanged" />
	</SfNumericTextBox>

	<SfNumericTextBox TValue="decimal?"
					  Placeholder="Enter Credit"
					  Value="_selectedCart?.Credit"
					  Format="N2"
					  Min="0">
		<NumericTextBoxEvents TValue="decimal?" ValueChange="OnCreditChanged" />
	</SfNumericTextBox>

	<SfTextBox Placeholder="Ledger Remarks" Value="@_selectedCart?.Remarks" ValueChanged="OnRemarksChanged" />

	<SfButton Content="Retrieve References" OnClick="RetrieveReferences" />

	<SfComboBox TValue="LedgerOverviewModel?"
				TItem="LedgerOverviewModel"
				Value="_selectedLedgerReference"
				DataSource="_ledgerReferences"
				Placeholder="Select Reference">
		<ComboBoxEvents TItem="LedgerOverviewModel" TValue="LedgerOverviewModel?" ValueChange="OnReferenceChanged" />
		<ComboBoxFieldSettings Text="ReferenceNo" Value="Id" />
	</SfComboBox>

	<SfButton Content="Add Ledger to Cart" OnClick="AddToCart" />
}